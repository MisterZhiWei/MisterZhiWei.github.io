<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="自动化打包," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="前言自动化打包根本目的是为了节约时间，把重复且无技术含量的事情交给机器去做。Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。更多的介绍大家自行百度，这里就不啰嗦了。 由于工作需要，我们存在的自动打包的工程有3种，一种是单一的工程打包；一种是集成cocoapod的打包；还有一种是有www文件需">
<meta name="keywords" content="自动化打包">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS开发-自动化打包Jenkins集成">
<meta property="og:url" content="http://yoursite.com/2018/01/09/iOS开发-自动化打包Jenkins集成/index.html">
<meta property="og:site_name" content="zwBlog">
<meta property="og:description" content="前言自动化打包根本目的是为了节约时间，把重复且无技术含量的事情交给机器去做。Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。更多的介绍大家自行百度，这里就不啰嗦了。 由于工作需要，我们存在的自动打包的工程有3种，一种是单一的工程打包；一种是集成cocoapod的打包；还有一种是有www文件需">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-96c21f9ee4b54a42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-160ee31dd6cad753.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-90b476898e490109.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-d4ab5ca2224989c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-bbab702aa28a8e41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-a4b80b3ec2a27eeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-72215120c022c2cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-491f2247a2dbaf9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-b497a493547427f2.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-02cafed5111ff020.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-595ed579a27faaa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-80bc0325c7e155ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-49c0ac3e328d99d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-6c7d2819716c2806.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-0f70206ebc74a624.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-681f801c5f381691.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-f8f1f66189dfa0d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-4072fb3458020d6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-88a2212c863da19e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-e9abae826e538bf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-d028a44c1300eec3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-9b495f6866548053.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-2a794ec639134b01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-30121ccbc5b8aba8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-10237d3047cd6221.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-58c07a846775b8cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-23d691754fcd3b08.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-aa003774ff94de9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-72974b45f111e71a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-4530aadf1bc7a2fb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-625e6f486ce18f2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-ee5ac1075af6ba6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-1098061c38563d29.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-6e27a72e96c1ff03.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-1ed99c562205e107.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-5b4ecce56084da9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-22ffca2a71592b7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-3f39fa64ee4f2ac3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-d7e1f9f0a5a2286c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-3a3f41810cd8f0cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/308319-e595ae6f062ab8fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-08-02T06:03:26.701Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS开发-自动化打包Jenkins集成">
<meta name="twitter:description" content="前言自动化打包根本目的是为了节约时间，把重复且无技术含量的事情交给机器去做。Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。更多的介绍大家自行百度，这里就不啰嗦了。 由于工作需要，我们存在的自动打包的工程有3种，一种是单一的工程打包；一种是集成cocoapod的打包；还有一种是有www文件需">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/308319-96c21f9ee4b54a42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/01/09/iOS开发-自动化打包Jenkins集成/"/>





  <title>iOS开发-自动化打包Jenkins集成 | zwBlog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?926d5bc189fa5fc245e426f70c23b8fd";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zwBlog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我的心愿是...世界和平</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/09/iOS开发-自动化打包Jenkins集成/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhiWei">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/img/icon.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zwBlog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">iOS开发-自动化打包Jenkins集成</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-09T13:44:56+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具/" itemprop="url" rel="index">
                    <span itemprop="name">工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://upload-images.jianshu.io/upload_images/308319-96c21f9ee4b54a42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>自动化打包根本目的是为了节约时间，把重复且无技术含量的事情交给机器去做。Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。更多的介绍大家自行百度，这里就不啰嗦了。</p>
<p>由于工作需要，我们存在的自动打包的工程有3种，一种是单一的工程打包；一种是集成cocoapod的打包；还有一种是有www文件需要插入到工程里的打包方式，后边会一一讲到3种配置。<br><a id="more"></a><br>环境配置：<br>Mac OS 10.12.6<br>Xcode9.2</p>
<h3 id="一、Jenkins安装"><a href="#一、Jenkins安装" class="headerlink" title="一、Jenkins安装"></a>一、Jenkins安装</h3><p>打开<a href="https://jenkins.io" target="_blank" rel="noopener">Jenkins官网</a>下载最新的pkg安装包。安装完成之后，Safari可能会自动打开，如果没有自动打开，打开浏览器，输入<code>http://localhost:8080</code>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-160ee31dd6cad753.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这时候可能出现这个页面，这个问题的原因就是Java环境有问题，需要重装Java环境。<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">下载Java的JDK</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-90b476898e490109.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>一般会有2个版本可选，选一个下载即可，下载完安装后打开终端，cd进入到jenkins.war包所在目录，执行以下命令：<br><code>$ java -jar jenkins.war --httpPort=8080</code><br>httpPort指的就是Jenkins所使用的http端口，这里指定8080(默认的就是这个)，可根据具体情况来修改。待Jenkins启动后，在浏览器页面输入以下地址:<code>http://localhost:8080</code>这样就可以打开Jenkins管理页面了。</p>
<h4 id="接下来是我们遇到的第一个坑也是需要注意的地方。"><a href="#接下来是我们遇到的第一个坑也是需要注意的地方。" class="headerlink" title="接下来是我们遇到的第一个坑也是需要注意的地方。"></a>接下来是我们遇到的第一个坑也是需要注意的地方。</h4><p>一般来说浏览器直接打开<code>http://localhost:8080</code>并没什么不对，但是等你用Jenkins打包的时候你会发现有各种权限的报错问题。原因就是直接用浏览器打开创建账号，那么Jenkins的工作目录会建立在/Users/Shared/Jenkins下。具体过程参见 <a href="http://stackoverflow.com/questions/9245149/jenkins-on-os-x-xcodebuild-gives-code-sign-error" target="_blank" rel="noopener">stackoverflow</a>。<br>正确的启动方式是：<br><code>$ sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist</code><br><code>$  java -jar /Applications/Jenkins/jenkins.war --httpPort=8080</code><br>这时，Jenkies会在/Users/[user name]/.Jenkins 下面建立工作目录，从而它就有权限去获取相关的keychain。<code>.Jenkins</code>是一个隐藏文件，通过进入文件夹路径的方式查看或者显示隐藏文件查看。<br><code>$ defaults write com.apple.finder AppleShowAllFiles -bool true</code>    此命令显示隐藏文件<br><code>$ defaults write com.apple.finder AppleShowAllFiles -bool false</code>  此命令关闭显示隐藏文件<br>执行显示或隐藏命令后需要重新启动Finder即可执行。</p>
<p>此时你可能会遇到<code>/Library/LaunchDaemons/org.jenkins-ci.plist: No such file or directory</code>这样的报错信息，但你用Finder打开路径是有这个文件的，然后你copy文件的路径发现就是这个路径，此时你再去执行<br><code>$ sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist</code><br>就会提示你deny permission，需要输入密码，这时就正常了。</p>
<p>输入<code>$ java -jar /Applications/Jenkins/jenkins.war --httpPort=8080</code>之后如果出现下边的信息就标识Jenkins已经启动了。<br><img src="http://upload-images.jianshu.io/upload_images/308319-d4ab5ca2224989c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>此时在浏览器输入<code>http://localhost:8080</code>即可。</p>
<h4 id="注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。"><a href="#注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。" class="headerlink" title="注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。"></a>注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。</h4><h3 id="二、Jenkins账号设置"><a href="#二、Jenkins账号设置" class="headerlink" title="二、Jenkins账号设置"></a>二、Jenkins账号设置</h3><p>如果Jenkins安装完是用浏览器直接打开<code>http://localhost:8080</code>，那么应该是如下的显示界面。<br><img src="http://upload-images.jianshu.io/upload_images/308319-bbab702aa28a8e41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1194012-c8468fd91737f725.png"></p>
<p>红色的路径就是让我们找到密码的路径，如果是通过命令行输入后浏览器打开地址，那么红色的提示路径就会是<code>/Users/[user name]/.Jenkins/.......</code>就表明Jenkins在当前的登录账号下建立了工作目录，之后会省去很多麻烦。<br>按路径打开时发现secrets文件夹无权限访问，右键点击文件夹 -&gt; 显示简介 -&gt; 打开共享与权限 ，给everyone加上读与写权限，进入文件夹后可以看到名字为initialAdminPassword的文件。<br><img src="http://upload-images.jianshu.io/upload_images/308319-a4b80b3ec2a27eeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这个文件夹也有权限问题，按上边的操作修改下权限即可，打开后可以拷贝里边的密码，然后在Jenkins页面上输入即可。</p>
<p>然后点击install suggested plugins ，即下载推荐插件。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-72215120c022c2cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-491f2247a2dbaf9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-b497a493547427f2.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>到这就可以设置用户名和密码了。<br><img src="http://upload-images.jianshu.io/upload_images/308319-02cafed5111ff020.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-595ed579a27faaa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="三、安装插件及添加钥匙串和描述文件等准备"><a href="#三、安装插件及添加钥匙串和描述文件等准备" class="headerlink" title="三、安装插件及添加钥匙串和描述文件等准备"></a>三、安装插件及添加钥匙串和描述文件等准备</h3><p>因为我们用的是GitLab来管理源代码，Jenkins本身并没有自带GitLab插件，所以我们需要依次选择 系统管理-&gt;管理插件，在“可选插件”中选中“GitLab Plugin”和“Gitlab Hook Plugin”这两项，然后安装。</p>
<p>如果你想用Xcode插件作为配置打包任务可以下载 xcode integration插件，下载方式也是系统管理-&gt;管理插件，在“可选插件”中搜索下载。不过我还是偏向与脚本的方式，因为脚本虽然麻烦些但是更加灵活。比如我们打包的命名方式，打完包的存放文件路径等都可以通过脚本做配置。</p>
<p>自动打包的job任务配置也需要添加钥匙串和描述文件，这时需要安装Keychains and Provisioning Profiles Management插件，安装后在Jenkins首页点击系统管理会找到这个插件，点击进去。<br><img src="http://upload-images.jianshu.io/upload_images/308319-80bc0325c7e155ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-49c0ac3e328d99d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>如图这里可以上传的文件时钥匙串和描述文件。不能直接上传证书文件。钥匙串的目录可以打开钥匙串点击<code>登录</code>钥匙串查看。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-6c7d2819716c2806.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>按图索骥，按显示的路径通过Finder直接打开文件夹。<br><img src="http://upload-images.jianshu.io/upload_images/308319-0f70206ebc74a624.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后拷贝一份安装有我们打包证书的钥匙串文件，即login.keychain-db。此时需要注意，上传到Jenkins的只认<code>.keychain</code>后缀和<code>.mobileprovision</code>后缀的文件，其他文件都会上传失败。所以我们要把这个上传的钥匙串后缀的<code>-db</code>去掉，文件名修改成login.keychain，然后再上传。</p>
<p>上传成功后Keychains下边会显示Filename为login.keychain，可以添加打包用的证书。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-681f801c5f381691.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这个名字可以在钥匙串中点击查看。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-f8f1f66189dfa0d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>接下来添加描述文件，先添加描述文件的导向路径，<br><code>/Users/[user name]/Library/MobileDevice/Provisioning Profiles</code><br>。描述文件和钥匙串一样的添加上传方式。添加后就可以看到描述文件信息了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-4072fb3458020d6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>上传后点击 save 按钮保存就可以了。</p>
<h3 id="四、创建配置单一工程任务"><a href="#四、创建配置单一工程任务" class="headerlink" title="四、创建配置单一工程任务"></a>四、创建配置单一工程任务</h3><p>xcodebuild + xcrun命令<br>Xcode提供了一套构建打包的命令，就是xcodebuild和xcrun命令。xcodebuild把我们指定的任务打包成.app文件，xcrun将指定的.app文件转换为对应的.ipa文件。<br><a href="https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man1/xcodebuild.1.html" target="_blank" rel="noopener">xcodebuild官方文档</a>  和<a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/xcrun.1.html" target="_blank" rel="noopener">xcrun官方文档</a></p>
<p>接下来创建任务，Jenkins首页点击新建。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-88a2212c863da19e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>如果我们已经创建了任务，并且其他配置都一样就改个证书什么的，可以下滑看到可以复制一份现有的任务，输入名字就可以选择。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-e9abae826e538bf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>新建任务打开后，因为我们是用SVN管理代码，所以选Subversion。<br><img src="http://upload-images.jianshu.io/upload_images/308319-d028a44c1300eec3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-9b495f6866548053.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-2a794ec639134b01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>点击add添加SVN的账号和密码。</p>
<p>如果地址和账号密码都对，是这样的。<br><img src="http://upload-images.jianshu.io/upload_images/308319-30121ccbc5b8aba8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>路径不对，或账号密码不对。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-10237d3047cd6221.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h4 id="有两个自动化的配置比较重要："><a href="#有两个自动化的配置比较重要：" class="headerlink" title="有两个自动化的配置比较重要："></a>有两个自动化的配置比较重要：</h4><p>Poll SCM (poll source code management) 轮询源码管理<br>需要设置源码的路径才能起到轮询的效果。一般设置为类似结果： 0/5 <em> </em> <em> </em> 每5分钟轮询一次<br>Build periodically (定时build)<br>一般设置为类似： 00 20 <em> </em> * 每天 20点执行定时build 。当然两者的设置都是一样可以通用的。</p>
<p>详细的可以点开介绍查看。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-58c07a846775b8cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后选择打包证书和描述文件。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-23d691754fcd3b08.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>添加脚本</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-aa003774ff94de9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 工程名</span><br><span class="line">TARGET_NAME=&quot;VideoEditDemo&quot;</span><br><span class="line"></span><br><span class="line"># 文件名前缀</span><br><span class="line">APP_NAME=&quot;视频编辑&quot;</span><br><span class="line"></span><br><span class="line"># 证书</span><br><span class="line">CODE_SIGN_DISTRIBUTION=&quot;iPhone Distribution: Smao Tech Co.,LTD.&quot;</span><br><span class="line"># info.plist路径</span><br><span class="line">project_infoplist_path=&quot;./$&#123;TARGET_NAME&#125;/Info.plist&quot;</span><br><span class="line"></span><br><span class="line">#取版本号</span><br><span class="line">bundleShortVersion=$(/usr/libexec/PlistBuddy -c &quot;print CFBundleShortVersionString&quot; &quot;$&#123;project_infoplist_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line">#取build值</span><br><span class="line">bundleVersion=$(/usr/libexec/PlistBuddy -c &quot;print CFBundleVersion&quot; &quot;$&#123;project_infoplist_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line">DATE=&quot;$(date +%Y%m%d)&quot;</span><br><span class="line">IPANAME=&quot;$&#123;APP_NAME&#125;_V$&#123;bundleShortVersion&#125;_$&#123;DATE&#125;.ipa&quot;</span><br><span class="line"></span><br><span class="line">#要上传的ipa文件路径</span><br><span class="line">IPA_PATH=&quot;$HOME/Desktop/MyWorkPlace/自动化打包IPAs/$&#123;IPANAME&#125;&quot;</span><br><span class="line">echo $&#123;IPA_PATH&#125;</span><br><span class="line">echo &quot;$&#123;IPA_PATH&#125;&quot;&gt;&gt; text.txt</span><br><span class="line"></span><br><span class="line">#下面2行是没有Cocopods的用法</span><br><span class="line">echo &quot;=================clean=================&quot;</span><br><span class="line">xcodebuild -target &quot;$&#123;TARGET_NAME&#125;&quot;  -configuration &apos;Release&apos; clean</span><br><span class="line"></span><br><span class="line">echo &quot;+++++++++++++++++build+++++++++++++++++&quot;</span><br><span class="line">xcodebuild -target &quot;$&#123;TARGET_NAME&#125;&quot; -sdk iphoneos -configuration &apos;Release&apos;  CODE_SIGN_IDENTITY=&quot;$&#123;CODE_SIGN_DISTRIBUTION&#125;&quot; SYMROOT=&apos;$(PWD)&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xcrun -sdk iphoneos PackageApplication &quot;./Release-iphoneos/$&#123;TARGET_NAME&#125;.app&quot; -o ~/&quot;Desktop/MyWorkPlace/自动化打包IPAs/$&#123;IPANAME&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>要上传的ipa文件路径是我创建了一个文件夹专门用来放自动打包的。</p>
<p>构建一次，各个颜色代表的意义如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-72974b45f111e71a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>天气的晴雨表代表了任务的质量，这也是Jenkins的一个特色。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-4530aadf1bc7a2fb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>如果构建失败了，可以去查看Console Output可以查看log日志。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-625e6f486ce18f2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>到此，一个单一工程的自动化打包就配置好了。这时可以点应用  保存  ，然后点击构建，构建成功后可以点开存放ipa文件的文件夹找到对应的ipa安装包。</p>
<h3 id="五、配置cocoapod任务"><a href="#五、配置cocoapod任务" class="headerlink" title="五、配置cocoapod任务"></a>五、配置cocoapod任务</h3><p>这里为了不重复，只说与单一工程不同的地方。cocoapod需要install安装依赖的三方库，所以这里需要在原有的构建脚本前边加一个脚本。（cocoapod自动化打包install安装三方库速度特别慢，还有可能中途下载时间太长失败，重新点构建再试一般就没问题了）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-ee5ac1075af6ba6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#bin/bsah - l</span><br><span class="line"></span><br><span class="line">export LANG=en_US.UTF-8</span><br><span class="line"></span><br><span class="line">export LANGUAGE=en_US.UTF-8</span><br><span class="line"></span><br><span class="line">export LC_ALL=en_US.UTF-8</span><br><span class="line"></span><br><span class="line">cd 【你的工程目录】</span><br><span class="line"></span><br><span class="line">/usr/local/bin/pod install --verbose --no-repo-update</span><br></pre></td></tr></table></figure>
<p>第二个脚本也需要有些修改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 工程名</span><br><span class="line">TARGET_NAME=&quot;MeetingProject&quot;</span><br><span class="line"></span><br><span class="line"># 文件名前缀</span><br><span class="line">APP_NAME=&quot;会务产品&quot;</span><br><span class="line"></span><br><span class="line"># 证书</span><br><span class="line">CODE_SIGN_DISTRIBUTION=&quot;iPhone Distribution: Smartdot Technologies Co.,LTD.&quot;</span><br><span class="line"># info.plist路径</span><br><span class="line">project_infoplist_path=&quot;./$&#123;TARGET_NAME&#125;/Info.plist&quot;</span><br><span class="line"></span><br><span class="line">#取版本号</span><br><span class="line">bundleShortVersion=$(/usr/libexec/PlistBuddy -c &quot;print CFBundleShortVersionString&quot; &quot;$&#123;project_infoplist_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line">#取build值</span><br><span class="line">bundleVersion=$(/usr/libexec/PlistBuddy -c &quot;print CFBundleVersion&quot; &quot;$&#123;project_infoplist_path&#125;&quot;)</span><br><span class="line"></span><br><span class="line">DATE=&quot;$(date +%Y%m%d)&quot;</span><br><span class="line">IPANAME=&quot;$&#123;APP_NAME&#125;_V$&#123;bundleShortVersion&#125;_$&#123;DATE&#125;.ipa&quot;</span><br><span class="line"></span><br><span class="line">#要上传的ipa文件路径</span><br><span class="line">IPA_PATH=&quot;$HOME/Desktop/MyWorkPlace/自动化打包IPAs/$&#123;IPANAME&#125;&quot;</span><br><span class="line">echo $&#123;IPA_PATH&#125;</span><br><span class="line">echo &quot;$&#123;IPA_PATH&#125;&quot;&gt;&gt; text.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#下面2行是集成有Cocopods的用法</span><br><span class="line">echo &quot;=================clean=================&quot;</span><br><span class="line">xcodebuild -workspace &quot;$&#123;TARGET_NAME&#125;.xcworkspace&quot; -scheme &quot;$&#123;TARGET_NAME&#125;&quot;  -configuration &apos;Release&apos; clean</span><br><span class="line"></span><br><span class="line">echo &quot;+++++++++++++++++build+++++++++++++++++&quot;</span><br><span class="line">xcodebuild -workspace &quot;$&#123;TARGET_NAME&#125;.xcworkspace&quot; -scheme &quot;$&#123;TARGET_NAME&#125;&quot; -sdk iphoneos -configuration &apos;Release&apos; CODE_SIGN_IDENTITY=&quot;$&#123;CODE_SIGN_DISTRIBUTION&#125;&quot; SYMROOT=&apos;$(PWD)&apos;</span><br><span class="line"></span><br><span class="line">xcrun -sdk iphoneos PackageApplication &quot;./Release-iphoneos/$&#123;TARGET_NAME&#125;.app&quot; -o ~/&quot;Desktop/MyWorkPlace/自动化打包IPAs/$&#123;IPANAME&#125;&quot;</span><br></pre></td></tr></table></figure></p>
<p>此时你构建打包，应该会报这样的错</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-1098061c38563d29.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这是因为Jenkins没有安装cocoapod，打开用户偏好设置 -&gt; 用户与群组。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-6e27a72e96c1ff03.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>正常这里不会有Jenkins这个名字，除非你设置过。这里是我已经给Jenkins设置过了，右键点击高级选项，把名字写上。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-1ed99c562205e107.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>我们需要给Jenkins一个密码，如果之前没设置过密码，这里应该是更改密码，否则是重置密码。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-5b4ecce56084da9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>为了可以快速切换登录账号，我们需要这样的勾选。<br><img src="http://upload-images.jianshu.io/upload_images/308319-22ffca2a71592b7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后可以在这里快速切换登录用户，接下来就可以切换登录Jenkins账号，安装cocoapod环境了，安装完成后，cocoapod自动化打包就没什么问题了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-3f39fa64ee4f2ac3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="六、配置插入文件打包任务"><a href="#六、配置插入文件打包任务" class="headerlink" title="六、配置插入文件打包任务"></a>六、配置插入文件打包任务</h3><p>添加SVN地址，这里因为我们SVN这个目录下的文件就为WWW，所以复制过来也要建立一个www文件夹放这些文件，否则这些文件就直接复制到工程目录一级目录下非常散乱。<br><img src="http://upload-images.jianshu.io/upload_images/308319-d7e1f9f0a5a2286c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>有插入文件，自然需要在打包的时候插入进去，所以我们还需要在构建单一工程的脚本前加一段脚本。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-3a3f41810cd8f0cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"># Copyright by Galen (2014-2014)</span><br><span class="line"># All rights reserved</span><br><span class="line"></span><br><span class="line">APP=`find -L . -name *.app -type d`</span><br><span class="line">echo &quot;will cp source file to:&quot;$APP&quot;...&quot;</span><br><span class="line">#exit 1</span><br><span class="line">\cp -aR $WORKSPACE/www &quot;$APP&quot;</span><br><span class="line"></span><br><span class="line"># 删除隐藏文件</span><br><span class="line">for X in `find -L &quot;$APP&quot; -name *.svn*`</span><br><span class="line">do</span><br><span class="line">rm -rf &quot;$X&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h3 id="七、上传蒲公英应用管理平台"><a href="#七、上传蒲公英应用管理平台" class="headerlink" title="七、上传蒲公英应用管理平台"></a>七、上传蒲公英应用管理平台</h3><p>我们既然要自动化就自动化到底，所以我们打出来的安装包应该自动上传到一个应用管理平台，这样别人就可以直接下载测试或使用。一般常用的是上传到蒲公英应用管理平台。</p>
<h4 id="1-安装fir-clifir的命令行工具，需要先装好ruby再执行"><a href="#1-安装fir-clifir的命令行工具，需要先装好ruby再执行" class="headerlink" title="1.安装fir-clifir的命令行工具，需要先装好ruby再执行"></a>1.安装fir-clifir的命令行工具，需要先装好ruby再执行</h4><p><code>gem install fir-cli</code></p>
<h4 id="2-自动上传至蒲公英"><a href="#2-自动上传至蒲公英" class="headerlink" title="2.自动上传至蒲公英"></a>2.自动上传至蒲公英</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#蒲公英上的User Key</span><br><span class="line">uKey=&quot;9dba14768e*****8e7a606ea31e04&quot;</span><br><span class="line">#蒲公英上的API Key</span><br><span class="line">apiKey=&quot;88127f49b2******e9536babe6920c10&quot;</span><br><span class="line">#要上传的ipa文件路径</span><br><span class="line"></span><br><span class="line">#要上传的ipa文件路径</span><br><span class="line">IPA_PATH=$(cat text.txt)</span><br><span class="line"></span><br><span class="line">rm -rf text.txt</span><br><span class="line"></span><br><span class="line">#执行上传至蒲公英的命令</span><br><span class="line">echo &quot;++++++++++++++上传蒲公英 上传中 +++++++++++++&quot;</span><br><span class="line">curl -F &quot;file=@$&#123;IPA_PATH&#125;&quot; -F &quot;uKey=$&#123;uKey&#125;&quot; -F &quot;_api_key=$&#123;apiKey&#125;&quot; http://www.pgyer.com/apiv1/app/upload</span><br></pre></td></tr></table></figure>
<h3 id="八、过程中一些坑和小技巧"><a href="#八、过程中一些坑和小技巧" class="headerlink" title="八、过程中一些坑和小技巧"></a>八、过程中一些坑和小技巧</h3><ul>
<li>1.Jenkins工作目录不在当前登录用户下的权限问题<br>这个问题在最开始就说了，这里的报错只是其中的个别，还有其他提示的权限问题基本都是Jenkins工作目录引起的权限问题。当然，你可以点开对应的路径下的文件进行授权，但是这意味着路径上的每一个文件都需要这样的授权处理，并且报一次错就得来这么一轮，我们不可能这么操作。<h4 id="所以工作目录的问题其实很重要。"><a href="#所以工作目录的问题其实很重要。" class="headerlink" title="所以工作目录的问题其实很重要。"></a>所以工作目录的问题其实很重要。</h4>报错：<br>Command /usr/bin/codesign failed with exit code 1 <strong> ARCHIVE FAILED </strong></li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/308319-e595ae6f062ab8fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<ul>
<li>2.xcrun: error: unable to find utility “PackageApplication”, not a developer tool or in PATH</li>
</ul>
<p><a href="http://blog.csdn.net/itiapp_home/article/details/70241011" target="_blank" rel="noopener">解决办法</a></p>
<ul>
<li>3.unknown error -1=ffffffffffffffff Command /bin/sh failed with exit code 1</li>
</ul>
<p>这个错的问题可能有很多种，这里有几种原因和处理方式：<br><a href="https://www.cnblogs.com/tufei7/p/6159811.html" target="_blank" rel="noopener">原因1</a><br><a href="https://www.jianshu.com/p/cda327047524" target="_blank" rel="noopener">原因2</a></p>
<ul>
<li>4.error: exportArchive: “AppName.app” requires a provisioning profile with the Push Notifications and App Groups features.<br>Error Domain=IDEProvisioningErrorDomain Code=9<br>“AppName.app” requires a provisioning profile with the Push Notifications and App Groups features.” UserInfo={NSLocalizedDescription=”AppName.app” requires a provisioning profile with the Push Notifications and App Groups features., NSLocalizedRecoverySuggestion=Add a profile to the “provisioningProfiles” dictionary in your Export Options property list.}<br>// 或<br>“Error Domain=IDEProvisioningErrorDomain Code=9 \”\”ios-simple-objc.app\” requires a provisioning profile.\”<br>UserInfo={NSLocalizedDescription=\”ios-simple-objc.app\” requires a provisioning profile., NSLocalizedRecoverySuggestion=Add a profile to the \”provisioningProfiles\” dictionary in your Export Options property list.}”<br><a href="http://blog.csdn.net/andanlan/article/details/78113330?locationNum=9&amp;fps=1" target="_blank" rel="noopener">解决方式</a></li>
</ul>
<p>不过笔者目前的Xcode9.2没有遇到这个提示，是之前Jenkins工作目录不对的时候调试出现过，用脚本添加ExportOptions.plist文件也不好使，如果有类似的问题大家还是百度并尝试吧。</p>
<ul>
<li><p>4.修改端口<br>如果要修改端口，比如7070，可在重启jenkins前执行以下命令修改端口参数:<br><code>sudo defaults write /Library/Preferences/org.jenkins-ci httpPort 7070</code><br>然后重启jenkins:<br><code>sudo launchctl unload -w /Library/LaunchDaemons/org.jenkins-ci.plist</code><br><code>sudo launchctl load -w /Library/LaunchDaemons/org.jenkins-ci.plist</code><br>到此，可以访问<code>http://localhost:7070</code>了。</p>
</li>
<li><p>5.Mac卸载Jenkins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//进入以下目录，双击运行</span><br><span class="line">/Library/Application Support/Jenkins/Uninstall.command</span><br><span class="line">//也可以这样运行</span><br><span class="line">sh &quot;/Library/Application Support/Jenkins/Uninstall.command&quot;</span><br><span class="line"></span><br><span class="line">//删除配置，这个可选</span><br><span class="line">sudo rm -rf /var/root/.jenkins ~/.jenkins</span><br><span class="line">sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist</span><br><span class="line">sudo rm /Library/LaunchDaemons/org.jenkins-ci.plist</span><br><span class="line">sudo rm -rf /Applications/Jenkins &quot;/Library/Application Support/Jenkins&quot; /Library/Documentation/Jenkins</span><br><span class="line">sudo rm -rf /Users/Shared/Jenkins</span><br><span class="line">sudo dscl . -delete /Users/jenkins</span><br><span class="line">sudo dscl . -delete /Groups/jenkins</span><br><span class="line">sudo rm -f /etc/newsyslog.d/jenkins.conf</span><br><span class="line">pkgutil --pkgs | grep &apos;org\.jenkins-ci\.&apos; | xargs -n 1 sudo pkgutil --forget</span><br><span class="line"></span><br><span class="line">//如果使用brew安装的，可以执行以下命令</span><br><span class="line">brew uninstall jenkins</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><a href="https://www.cnblogs.com/EasonJim/p/6277708.html" target="_blank" rel="noopener">参见</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/自动化打包/" rel="tag"># 自动化打包</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/25/iOS开发多线程-NSOperation-GCD详解/" rel="next" title="iOS开发多线程-NSOperation  GCD详解">
                <i class="fa fa-chevron-left"></i> iOS开发多线程-NSOperation  GCD详解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/02/05/学习要像加勒比海盗/" rel="prev" title="学习要像加勒比海盗">
                学习要像加勒比海盗 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/assets/img/icon.png"
               alt="ZhiWei" />
          <p class="site-author-name" itemprop="name">ZhiWei</p>
           
              <p class="site-description motion-element" itemprop="description">记录与分享</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一、Jenkins安装"><span class="nav-number">2.</span> <span class="nav-text">一、Jenkins安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#接下来是我们遇到的第一个坑也是需要注意的地方。"><span class="nav-number">2.1.</span> <span class="nav-text">接下来是我们遇到的第一个坑也是需要注意的地方。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。"><span class="nav-number">2.2.</span> <span class="nav-text">注意：这种方式打开的Jenkins在自动化打包时，不能关闭运行Java环境的终端。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、Jenkins账号设置"><span class="nav-number">3.</span> <span class="nav-text">二、Jenkins账号设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、安装插件及添加钥匙串和描述文件等准备"><span class="nav-number">4.</span> <span class="nav-text">三、安装插件及添加钥匙串和描述文件等准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、创建配置单一工程任务"><span class="nav-number">5.</span> <span class="nav-text">四、创建配置单一工程任务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#有两个自动化的配置比较重要："><span class="nav-number">5.1.</span> <span class="nav-text">有两个自动化的配置比较重要：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、配置cocoapod任务"><span class="nav-number">6.</span> <span class="nav-text">五、配置cocoapod任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、配置插入文件打包任务"><span class="nav-number">7.</span> <span class="nav-text">六、配置插入文件打包任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#七、上传蒲公英应用管理平台"><span class="nav-number">8.</span> <span class="nav-text">七、上传蒲公英应用管理平台</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-安装fir-clifir的命令行工具，需要先装好ruby再执行"><span class="nav-number">8.1.</span> <span class="nav-text">1.安装fir-clifir的命令行工具，需要先装好ruby再执行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-自动上传至蒲公英"><span class="nav-number">8.2.</span> <span class="nav-text">2.自动上传至蒲公英</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#八、过程中一些坑和小技巧"><span class="nav-number">9.</span> <span class="nav-text">八、过程中一些坑和小技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#所以工作目录的问题其实很重要。"><span class="nav-number">9.1.</span> <span class="nav-text">所以工作目录的问题其实很重要。</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear"> 2018</span>

  <span class="author" itemprop="copyrightHolder">ZhiWei</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
